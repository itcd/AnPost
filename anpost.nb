(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     17055,        392]
NotebookOptionsPosition[     16210,        371]
NotebookOutlinePosition[     16584,        387]
CellTagsIndexPosition[     16541,        384]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"AnPost", "[", 
   RowBox[{"number_", ",", "office_", ",", 
    RowBox[{"origin_:", "\"\<IE\>\""}], ",", 
    RowBox[{
    "prefix_:", 
     "\"\<https://www.anpost.com/Commerce/Track/History?item=\>\""}], ",", 
    RowBox[{"beginning_:", "\"\<Track again\>\""}], ",", 
    RowBox[{
    "ending_:", "\"\<Parcel solutions built for your business\>\""}]}], "]"}],
   ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"list", ",", "start", ",", "id", ",", "end"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"URLExecute", "[", 
         RowBox[{"prefix", "<>", "number"}], "]"}], ",", "\"\<\\n\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"start", "=", 
      RowBox[{"FirstPosition", "[", 
       RowBox[{"list", ",", 
        RowBox[{"_String", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"#", ",", "beginning"}], "]"}], "&"}], ")"}]}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"ListQ", "@", "start"}]}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"{", 
         RowBox[{"number", ",", "beginning", ",", "start"}], "}"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"id", "=", 
      RowBox[{"SelectFirst", "[", 
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{"list", "[", 
          RowBox[{"[", 
           RowBox[{"First", "@", "start"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"#", ",", "origin"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"end", "=", 
      RowBox[{"FirstPosition", "[", 
       RowBox[{"list", ",", 
        RowBox[{"_String", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"#", ",", "ending"}], "]"}], "&"}], ")"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "id"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"id", ",", 
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"First", "@", "start"}], ";;", 
             RowBox[{"First", "@", "end"}]}], "]"}], "]"}]}], "}"}], "//", 
        RowBox[{
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{"StringQ", "@", 
            RowBox[{"SelectFirst", "[", 
             RowBox[{
              RowBox[{"Flatten", "@", "#"}], ",", 
              RowBox[{
               RowBox[{"StringContainsQ", "[", 
                RowBox[{"#", ",", "office"}], "]"}], "&"}]}], "]"}]}], ",", 
           "#", ",", "Nothing"}], "]"}], "&"}]}], ",", "Nothing"}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AnPostCombine", "[", 
   RowBox[{"number_", ",", "from_", ",", "via_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AnPost", "[", 
    RowBox[{"number", ",", "from"}], "]"}], "//", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ListQ", "@", "#"}], ",", 
      RowBox[{"Append", "[", 
       RowBox[{"#", ",", 
        RowBox[{"AnPost", "[", 
         RowBox[{
          RowBox[{"First", "@", "#"}], ",", "via"}], "]"}]}], "]"}], ",", 
      "Nothing"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListFilter", "[", 
   RowBox[{"ids_", ",", 
    RowBox[{"from_:", "\"\<G.P.O.\>\""}], ",", 
    RowBox[{"via_:", "\"\<LONDON\>\""}], ",", 
    RowBox[{"to_:", "\"\<CHINA\>\""}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"result", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AnPostCombine", "[", 
          RowBox[{"i", ",", "from", ",", "via"}], "]"}], "//", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ListQ", "@", "#"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "#"}], "}"}], ",", "Nothing"}], "]"}], "&"}]}],
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ids"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Select", "[", 
      RowBox[{"result", ",", 
       RowBox[{
        RowBox[{"StringQ", "@", 
         RowBox[{"SelectFirst", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", "#"}], ",", 
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "to"}], "]"}], "&"}]}], "]"}]}], "&"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListExport", "[", 
   RowBox[{"list_", ",", 
    RowBox[{"dir_:", "\"\<json\>\""}]}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", "dir", ",", 
         RowBox[{
          RowBox[{"First", "@", "i"}], "<>", "\"\<.json\>\""}]}], "}"}], 
       "]"}], ",", 
      RowBox[{"Last", "@", "i"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "list"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7755606335802784`*^9, 3.7755607447579317`*^9}, {
   3.775560799663327*^9, 3.775560812103668*^9}, 3.7755609075546584`*^9, 
   3.77556095823796*^9, {3.7755650528116817`*^9, 3.7755650985433316`*^9}, {
   3.775565194604413*^9, 3.7755651959222713`*^9}, {3.775565683534463*^9, 
   3.775565709507482*^9}, {3.7755657585022907`*^9, 3.7755657659899855`*^9}, {
   3.775565811269895*^9, 3.775565851157529*^9}, 3.7755659134633675`*^9, {
   3.7755660229772606`*^9, 3.7755660917476287`*^9}, {3.775566137547052*^9, 
   3.775566139995641*^9}, {3.775568856796653*^9, 3.7755689426168194`*^9}, {
   3.7755689837551255`*^9, 3.7755690014948883`*^9}, {3.775569181098362*^9, 
   3.7755691827714014`*^9}, {3.7755692203717365`*^9, 3.7755692321089687`*^9}, 
   3.7755692702461786`*^9, {3.775569315996817*^9, 3.7755693413102255`*^9}, {
   3.7755693876786003`*^9, 3.7755693939030275`*^9}, {3.7755694351582403`*^9, 
   3.7755694464697304`*^9}, {3.775569854495182*^9, 3.7755698569147882`*^9}, {
   3.7755700460119195`*^9, 3.775570052080414*^9}, {3.775570123069141*^9, 
   3.7755701243523893`*^9}, {3.775591480267218*^9, 3.7755915637920723`*^9}, {
   3.7755916360795403`*^9, 3.775591647512952*^9}, 3.7755917005873613`*^9, {
   3.7755917499599133`*^9, 3.7755917730446053`*^9}, {3.7755918082223344`*^9, 
   3.7755918090368633`*^9}, {3.7755918443710775`*^9, 
   3.7755918517078457`*^9}, {3.775591896400091*^9, 3.7755919624020452`*^9}, {
   3.7755921973304424`*^9, 3.7755922089567432`*^9}, {3.77559224964028*^9, 
   3.7755922571379766`*^9}, {3.7755930048954754`*^9, 3.775593013223671*^9}, {
   3.7755931797157297`*^9, 3.775593210244749*^9}, {3.7755947265278063`*^9, 
   3.7755947302496743`*^9}, {3.775594862924215*^9, 3.7755949471172647`*^9}, 
   3.775595431571486*^9, {3.7755954756151686`*^9, 3.7755955163387156`*^9}, {
   3.7755956056412597`*^9, 3.775595610358529*^9}, {3.7755956878588667`*^9, 
   3.7755958075448933`*^9}, {3.7755966274510837`*^9, 3.775596632659102*^9}, {
   3.775596770661066*^9, 3.775596776528685*^9}, {3.775596823385188*^9, 
   3.775596866753196*^9}, {3.7755970089833503`*^9, 3.775597025168023*^9}, {
   3.775597089693838*^9, 3.7755970950687413`*^9}, {3.7755983186488504`*^9, 
   3.7755983222197924`*^9}, {3.775606761783827*^9, 3.775606802827569*^9}, {
   3.7756068660501966`*^9, 3.77560686765827*^9}, {3.7756093249922314`*^9, 
   3.775609359953178*^9}, 3.7756094252885222`*^9, {3.775610101889924*^9, 
   3.7756101385518064`*^9}, {3.775610221841175*^9, 3.775610227080152*^9}, 
   3.7756115564475937`*^9, {3.7756116122404413`*^9, 3.7756116316712303`*^9}, {
   3.7756118992217855`*^9, 3.7756119055741243`*^9}, {3.775611937527711*^9, 
   3.7756120930180902`*^9}, {3.7756122711369667`*^9, 
   3.7756122752615905`*^9}, {3.7756125066009183`*^9, 
   3.7756125083119383`*^9}, {3.7756125626069927`*^9, 
   3.7756126911339383`*^9}, {3.7756140869835186`*^9, 
   3.7756141522908845`*^9}, {3.7756141857039766`*^9, 3.77561419326362*^9}, 
   3.7756144817504325`*^9, {3.7756152181282988`*^9, 3.7756152307860084`*^9}, {
   3.775621878891554*^9, 3.775621905768061*^9}, {3.7756219783213186`*^9, 
   3.775622010778614*^9}, {3.7756220602827053`*^9, 3.775622064274414*^9}, {
   3.7756223009960423`*^9, 3.7756223489863853`*^9}, {3.775622396084256*^9, 
   3.7756224027450237`*^9}, {3.7756226461670856`*^9, 3.775622661631173*^9}, {
   3.7756228064410954`*^9, 3.775622809871112*^9}, {3.775652608343451*^9, 
   3.7756526468357844`*^9}, 3.775652724115264*^9, 3.7756533494829025`*^9, {
   3.7756535012224464`*^9, 3.775653510199275*^9}, 3.7756537377115655`*^9, 
   3.7756537878851795`*^9, {3.775678855928146*^9, 3.7756788689426584`*^9}, {
   3.7756789174295335`*^9, 3.775678919579299*^9}, 3.775678966838065*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"9e27fb9d-22d0-4d2c-8979-4564630a36a2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\"\<json\>\"", "//", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", "#", "]"}]}], ",", 
      RowBox[{"CreateDirectory", "[", "#", "]"}]}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lists", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"\"\<EF7286\>\"", "<>", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"i", ",", "10", ",", "5"}], "]"}], "<>", "\"\<IE\>\""}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "99999"}], "}"}]}], "]"}], "//", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"#", ",", 
       RowBox[{"UpTo", "[", "100", "]"}]}], "]"}], "&"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.775596636208037*^9, 3.775596636587819*^9}, {
   3.7755969063333864`*^9, 3.7755969109377337`*^9}, {3.7755970534357347`*^9, 
   3.77559705704965*^9}, {3.775600156478813*^9, 3.775600156769648*^9}, {
   3.7756001988334055`*^9, 3.775600225136248*^9}, {3.775600389436592*^9, 
   3.7756004164380336`*^9}, 3.775601940636711*^9, {3.775606685875553*^9, 
   3.775606696466468*^9}, {3.775607250903061*^9, 3.7756072672516413`*^9}, {
   3.7756151346564026`*^9, 3.775615180430025*^9}, {3.775615474417592*^9, 
   3.775615479513652*^9}, {3.775615566194236*^9, 3.7756155724526296`*^9}, 
   3.7756221925930014`*^9, 3.7756328984643908`*^9, 3.775637276370053*^9, 
   3.775638796042611*^9, 3.7756432167803288`*^9, 3.7756447142397604`*^9, {
   3.775650281911871*^9, 3.7756503114099035`*^9}, 3.775650446749878*^9, 
   3.7756518043893137`*^9, {3.775652311395557*^9, 3.775652338410988*^9}, {
   3.7756524002524686`*^9, 3.775652403904364*^9}, {3.775652836584483*^9, 
   3.7756528374769735`*^9}, 3.775654971866981*^9, {3.7756829791920424`*^9, 
   3.775682986586778*^9}, {3.775683201626479*^9, 3.7756832023910427`*^9}, 
   3.7756832412511373`*^9, {3.7756833148820753`*^9, 3.775683316006409*^9}, 
   3.7756892294364347`*^9, 3.775689466580364*^9, {3.7756895695258427`*^9, 
   3.7756895703863487`*^9}, 3.775690914108967*^9, 3.775693334366214*^9},
 CellLabel->"In[5]:=",ExpressionUUID->"9fddd004-d51f-4add-8717-8a97911352ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListExport", "[", 
      RowBox[{"ListFilter", "[", "i", "]"}], "]"}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "lists"}], "}"}]}], "]"}], ",", 
   RowBox[{"Framed", "[", 
    RowBox[{"Short", "@", "i"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.775615346457529*^9, 3.775615352155755*^9}, {
   3.7756155222065697`*^9, 3.77561553029191*^9}, 3.7756528405082083`*^9, {
   3.775653462469892*^9, 3.775653477080468*^9}, {3.775653570184213*^9, 
   3.775653580532266*^9}, {3.7756537193011923`*^9, 3.775653730331831*^9}, 
   3.7756900733327312`*^9, {3.7756912221107144`*^9, 3.775691224778177*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"84ee0b63-47f9-412f-939b-8cca172b5a1a"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   Framed[
    Short[$CellContext`i]], StandardForm],
  Evaluator->"Local",
  ImageSizeCache->{667., {11., 19.}}]], "PrintTemporary",
 CellChangeTimes->{3.775693413089384*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"f4b6154c-43e0-46bd-8530-3a432daec180"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ids", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<EF728619376IE\>\"", ",", "\"\<EF728642661IE\>\"", ",", 
     "\"\<CL074519209IE\>\"", ",", "\"\<CL075195685IE\>\"", ",", 
     "\"\<EF728619377IE\>\"", ",", "\"\<EF728610805IE\>\"", ",", 
     "\"\<EF728616953IE\>\"", ",", "\"\<EF728600009IE\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"number", "=", 
   RowBox[{"First", "@", "ids"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"origin", "=", "\"\<IE\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "prefix", "=", 
   "\"\<https://www.anpost.com/Commerce/Track/History?item=\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beginning", "=", "\"\<Track again\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ending", "=", "\"\<Parcel solutions built for your business\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"from", "=", "\"\<G.P.O.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"via", "=", "\"\<LONDON\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"to", "=", "\"\<CHINA\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"office", "=", "from"}], ";"}]}], "Input",
 CellChangeTimes->{{3.775565918881246*^9, 3.7755659345931997`*^9}, {
   3.775566522254131*^9, 3.775566558732101*^9}, {3.775568743504923*^9, 
   3.7755687517031894`*^9}, 3.7755701741374702`*^9, {3.775591431477688*^9, 
   3.7755914352315245`*^9}, {3.7755921224748526`*^9, 3.7755921546023464`*^9}, 
   3.775594591929926*^9, {3.7755950711504803`*^9, 3.7755950717051625`*^9}, {
   3.775595269012578*^9, 3.7755952796504645`*^9}, {3.7755965406630697`*^9, 
   3.775596543906201*^9}, {3.7755978217086396`*^9, 3.7755978219684873`*^9}, {
   3.7755982559799757`*^9, 3.7755982581697035`*^9}, {3.7756001507960896`*^9, 
   3.7756001601087236`*^9}, {3.775607457750358*^9, 3.7756074630229235`*^9}, {
   3.7756087205645247`*^9, 3.775608740953777*^9}, {3.7756090241685357`*^9, 
   3.775609025064657*^9}, {3.7756091728606443`*^9, 3.775609173034545*^9}, 
   3.7756095758210287`*^9, {3.77561035523353*^9, 3.775610355376446*^9}, {
   3.7756147666552286`*^9, 3.775614777859785*^9}, {3.7756148100242596`*^9, 
   3.775614810971714*^9}, {3.7756151319679537`*^9, 3.775615132715507*^9}, {
   3.7756504662806187`*^9, 3.7756505551593666`*^9}, {3.7756791282432947`*^9, 
   3.775679173768583*^9}, {3.775691753149926*^9, 
   3.7756917751527667`*^9}},ExpressionUUID->"5275d5af-0f3e-48a6-b090-\
111b39a63660"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ListExport", "[", 
    RowBox[{"ListFilter", "[", "ids", "]"}], "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.775650654259454*^9, 3.775650655391307*^9}, {
  3.775650763419175*^9, 3.7756508140862427`*^9}, {3.7756791382994986`*^9, 
  3.775679143066762*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"f6e91674-5cdb-432d-91a5-53d4a85e638d"]
},
WindowSize->{1218, 677},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 9235, 205, 468, "Input",ExpressionUUID->"9e27fb9d-22d0-4d2c-8979-4564630a36a2"],
Cell[9796, 227, 2308, 46, 84, "Input",ExpressionUUID->"9fddd004-d51f-4add-8717-8a97911352ee"],
Cell[CellGroupData[{
Cell[12129, 277, 837, 17, 84, "Input",ExpressionUUID->"84ee0b63-47f9-412f-939b-8cca172b5a1a"],
Cell[12969, 296, 314, 9, 42, "PrintTemporary",ExpressionUUID->"f4b6154c-43e0-46bd-8530-3a432daec180"]
}, Open  ]],
Cell[13298, 308, 2510, 51, 276, "Input",ExpressionUUID->"5275d5af-0f3e-48a6-b090-111b39a63660"],
Cell[15811, 361, 395, 8, 35, "Input",ExpressionUUID->"f6e91674-5cdb-432d-91a5-53d4a85e638d"]
}
]
*)

